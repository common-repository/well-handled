(function(){const o=new Vue({el:"#vue-search",data:window.whData,methods:{lastSearch:0,searchSubmit:function(){var e=this;this.forms.search.errors={},this.forms.search.loading=!0;var r=JSON.parse(JSON.stringify(this.forms.search));delete r.page,delete r.errors,delete r.loading,delete r.n,delete r.action;var s=this.hash(r);s!==this.lastSearch&&(this.forms.search.page=0,this.lastSearch=s),this.formAjax(this.forms.search,function(t){e.forms.search.loading=!1,e.searched=!0,e.results={page:0,pages:0,total:0,items:[]},t.ok&&t.data?e.results=t.data:t.errors?e.forms.search.errors=t.errors:e.forms.search.errors.other="The server garbled the last response. :(",e.scrollTo()})},pageSubmit:function(e){if(e=parseInt(e,10)||0,e!==0&&(this.forms.search.page+=e,0>this.forms.search.page?this.forms.search.page=0:this.forms.search.page>this.results.pages&&(this.forms.search.page=this.results.pages),this.forms.search.page!==this.results.page))return this.searchSubmit()},getMessage:function(e,r,s){this.modal=!0,e=e.replace(/\?wh_link=[A-Z0-9]{20}/g,"#tracking-removed-for-preview"),e=e.replace(/<img\s.[^>]*>/g,function(t){return t.indexOf("?wh_image")!==-1?"":t}),typeof r=="string"&&(this.preview.options=r),typeof s=="string"&&(this.preview.data=s),Vue.nextTick(function(){var t=document.getElementById("wh-modal--message");t.contentWindow.contents=e,t.src="javascript:window.contents"})},deleteError:function(e){if(e=parseInt(e,10)||0,!(0>=e)){var r=this;this.forms.delete.error_id=e,this.forms.delete.loading=!0,this.forms.delete.errors={},this.formAjax(this.forms.delete,function(s){r.forms.delete.loading=!1,s.ok&&s.data?(r.forms.delete.deleted=!0,setTimeout(function(){r.forms.delete.deleted=!1},2500),r.searchSubmit()):s.errors?r.forms.delete.errors=s.errors:r.forms.delete.errors.other="The server garbled the last response. :(",r.scrollTo()})}},retryError:function(e){if(e=parseInt(e,10)||0,!(0>=e)){var r=this;this.forms.retry.error_id=e,this.forms.retry.loading=!0,this.forms.retry.errors={},this.formAjax(this.forms.retry,function(s){r.forms.retry.loading=!1,s.ok&&s.data?(r.forms.retry.deleted=!0,setTimeout(function(){r.forms.retry.deleted=!1},2500),r.searchSubmit()):s.errors?r.forms.retry.errors=s.errors:r.forms.retry.errors.other="The server garbled the last response. :(",r.scrollTo()})}}},mounted:function(){this.searchSubmit()}});document.addEventListener("keyup",function(e){e=e||window.event,("key"in e&&(e.key==="Escape"||e.key==="Esc")||e.keyCode===27)&&(o.modal=!1)})})();
